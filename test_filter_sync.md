# 筛选同步功能测试指南

## 测试目标
验证修复后的筛选选项缓存和同步功能是否正常工作。

## 测试步骤

### 1. 搜索内容缓存测试

1. **打开应用** (http://localhost:3000)
2. **设置搜索内容**：
   - 点击搜索框展开
   - 输入搜索内容，例如："测试"
   - 等待搜索结果加载
3. **刷新页面**
4. **验证结果**：
   - ✅ 搜索框应该显示之前输入的"测试"
   - ✅ 任务列表应该显示筛选后的结果（不是所有记录）

### 2. 状态筛选缓存测试

1. **设置状态筛选**：
   - 点击状态筛选按钮展开
   - 选择"待办"
   - 等待筛选结果加载
2. **刷新页面**
3. **验证结果**：
   - ✅ 状态筛选按钮应该显示"待办"
   - ✅ 任务列表应该只显示待办任务（进行中+暂停中）

### 3. 任务类型筛选缓存测试

1. **设置任务类型筛选**：
   - 点击任务类型筛选按钮展开
   - 选择"工作"
   - 等待筛选结果加载
2. **刷新页面**
3. **验证结果**：
   - ✅ 任务类型筛选按钮应该显示"工作"
   - ✅ 任务列表应该只显示工作类型的任务

### 4. 优先级筛选缓存测试

1. **设置优先级筛选**：
   - 点击优先级筛选按钮展开
   - 选择"高"
   - 等待筛选结果加载
2. **刷新页面**
3. **验证结果**：
   - ✅ 优先级筛选按钮应该显示"高"
   - ✅ 任务列表应该只显示高优先级的任务

### 5. 组合筛选测试

1. **设置多个筛选条件**：
   - 搜索："项目"
   - 任务类型："工作"
   - 状态："待办"
   - 优先级："高"
2. **刷新页面**
3. **验证结果**：
   - ✅ 所有筛选条件都应该被保持
   - ✅ 任务列表应该显示符合所有条件的任务

### 6. 清空筛选测试

1. **清空所有筛选**：
   - 搜索框清空
   - 所有筛选选择"全部"
2. **刷新页面**
3. **验证结果**：
   - ✅ 所有筛选都应该显示默认状态
   - ✅ 任务列表应该显示所有任务

## 开发者工具验证

在浏览器控制台中运行以下命令来检查缓存状态：

```javascript
// 查看当前缓存的筛选选项
const cached = JSON.parse(localStorage.getItem('aigtd_filter_options') || '{}');
console.log('缓存的筛选选项:', cached);

// 检查各个筛选项
console.log('搜索查询:', cached.searchQuery);
console.log('状态筛选:', cached.statusFilter);
console.log('优先级筛选:', cached.priorityFilter);
console.log('任务类型筛选:', cached.selectedTaskType);
```

## 预期修复的问题

### 修复前的问题：
- ❌ 搜索内容刷新后丢失
- ❌ 筛选选项记住了但内容展示还是所有记录

### 修复后的预期：
- ✅ 搜索内容在刷新后保持
- ✅ 筛选选项记住且内容正确筛选
- ✅ 父组件和TaskList组件状态同步
- ✅ 初始加载时使用缓存的筛选条件

## 技术实现验证

### 1. Props传递验证
在React DevTools中检查TaskList组件是否接收到正确的props：
- `initialSearchQuery`
- `initialStatusFilter`
- `initialPriorityFilter`
- `initialTaskTypeFilter`

### 2. 状态同步验证
检查TaskList组件的内部状态是否与父组件状态一致：
- 搜索查询状态
- 各种筛选状态

### 3. API请求验证
在Network面板中检查API请求是否包含正确的筛选参数：
- `search` 参数
- `status` 参数
- `priority` 参数
- `task_type` 参数

## 故障排除

如果测试失败，检查：

1. **控制台错误**：查看是否有JavaScript错误
2. **Props传递**：确认父组件正确传递筛选状态
3. **状态初始化**：确认TaskList组件正确使用初始值
4. **API请求**：确认请求参数正确
5. **缓存状态**：确认localStorage中的数据正确

## 测试完成标准

- [ ] 搜索内容缓存正常工作
- [ ] 状态筛选缓存正常工作
- [ ] 任务类型筛选缓存正常工作
- [ ] 优先级筛选缓存正常工作
- [ ] 组合筛选缓存正常工作
- [ ] 清空筛选功能正常
- [ ] 父子组件状态同步正常
- [ ] API请求参数正确
